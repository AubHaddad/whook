[//]: # ( )
[//]: # (This file is automatically generated by a `metapak`)
[//]: # (module. Do not change it  except between the)
[//]: # (`content:start/end` flags, your changes would)
[//]: # (be overridden.)
[//]: # ( )
# @whook/versions
> A wrapper to provide versions check support to a Whook server

[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/nfroidure/whook/blob/master/packages/whook-versions/LICENSE)
[![NPM version](https://badge.fury.io/js/%40whook%2Fversions.svg)](https://npmjs.org/package/@whook/versions)


[//]: # (::contents:start)

This [Whook](https://github.com/nfroidure/whook)'s wrapper simply answer
 to any HTTP call with a unsupported version header with a 418 HTTP error.

To use this module, simply add it to your `WRAPPERS` service
 (usually in `src/services/WRAPPERS.ts`):
```diff
import { service } from 'knifecycle';
import { WhookWrapper } from '@whook/whook';
+ import { wrapHandlerWithVersions } from '@whook/versions';

export default service(initWrappers, 'WRAPPERS');

async function initWrappers(): Promise<WhookWrapper<any, any>[]> {
-  const WRAPPERS = [];
+  const WRAPPERS = [wrapHandlerWithVersions];

  return WRAPPERS;
}
```

And add the versions config and the errors descriptors or provide your
 own (usually in `src/config/common/config.js`):
```diff
import { DEFAULT_ERRORS_DESCRIPTORS } from '@whook/http-router';
+ import {
+   VERSIONS_ERRORS_DESCRIPTORS,
+   WhookVersionsConfig
+ } from '@whook/versions';

// ...

+ const VERSIONS = [
+   {
+     header: 'X-SDK-Version',
+     rule: '>=2.2.0',
+   },
+   {
+     header: 'X-APP-Version',
+     rule: '>=3.6.0',
+   },
+ ];

export type AppConfigs = WhookConfigs &
+  WhookVersionsConfig &
  APIConfig;

const CONFIG: AppConfigs = {
  // ...
-   ERRORS_DESCRIPTORS: DEFAULT_ERRORS_DESCRIPTORS,
+   ERRORS_DESCRIPTORS: {
+     ...DEFAULT_ERRORS_DESCRIPTORS,
+     ...VERSIONS_ERRORS_DESCRIPTORS,
+   },
  // ...
+   VERSIONS,
};

export default CONFIG;
```

[//]: # (::contents:end)

# API
## Functions

<dl>
<dt><a href="#wrapHandlerWithVersionChecker">wrapHandlerWithVersionChecker(initHandler)</a> ⇒ <code>function</code></dt>
<dd><p>Wrap an handler initializer to check versions headers.</p>
</dd>
<dt><a href="#augmentAPIWithVersionsHeaders">augmentAPIWithVersionsHeaders(API, VERSIONS)</a> ⇒ <code>Promise.&lt;Object&gt;</code></dt>
<dd><p>Augment an OpenAPI with versions headers added.</p>
</dd>
</dl>

<a name="wrapHandlerWithVersionChecker"></a>

## wrapHandlerWithVersionChecker(initHandler) ⇒ <code>function</code>
Wrap an handler initializer to check versions headers.

**Kind**: global function  
**Returns**: <code>function</code> - The handler initializer wrapped  

| Param | Type | Description |
| --- | --- | --- |
| initHandler | <code>function</code> | The handler initializer |

<a name="augmentAPIWithVersionsHeaders"></a>

## augmentAPIWithVersionsHeaders(API, VERSIONS) ⇒ <code>Promise.&lt;Object&gt;</code>
Augment an OpenAPI with versions headers added.

**Kind**: global function  
**Returns**: <code>Promise.&lt;Object&gt;</code> - The augmented  OpenAPI object  

| Param | Type | Description |
| --- | --- | --- |
| API | <code>Object</code> | The OpenAPI object |
| VERSIONS | <code>Object</code> | The versions configurations |


# Authors
- [Nicolas Froidure](http://insertafter.com/en/index.html)

# License
[MIT](https://github.com/nfroidure/whook/blob/master/packages/whook-versions/LICENSE)
